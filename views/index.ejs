<!DOCTYPE html>
<html>

<style>
    #clip {
        position: absolute;
        top: 0px;
        left: 0px;
    }
</style>

<body bgcolor="black">

<video id="clip" width="100%" height="100%" autoplay>
  <source type="video/mp4">
  Your browser does not support the video tag.
</video>

<script>
    const clips = <%- JSON.stringify(clips) %>;
    let shuffledClips = shuffle(clips)

    const clip = document.getElementById('clip');
    clip.addEventListener('ended', random, false);

    function play(source) {
    	clip.setAttribute('src', source);
    	clip.volume = 1		
    }

    random()
    function random() {
        if (!shuffledClips.length) shuffledClips = shuffle(clips)
        const source = `https://production.assets.clips.twitchcdn.net/${shuffledClips.pop()}`

        setTimeout(() => {
            play(source);
        }, 300);
    }

    function shuffle(array) {
        let res = [];
        for (var i = array.length - 1; i > 0; i--) {
            var j = Math.floor(Math.random() * (i + 1));
            var temp = array[i];
            res[i] = array[j];
            res[j] = temp;
        }
        return res;
    }
</script>

</body>
</html>
